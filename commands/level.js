const Discord = require('discord.js');

module.exports = {
    name: 'level',
    aliases: ['level'],
    description: "Check your level",
    usage: '',
    moderatorsOnly: true,
    ownerOnly: true, 
    guildOnly: true,
    cooldown: 3,
    run(client, msg, args, con) {
        const taggedUser = msg.mentions.users.first();
        con.query("SELECT `XP`, `Level` FROM `Users` WHERE `DiscordID` = '" + msg.author.id + "' LIMIT 1", function (err, result) {
            if (result.length) {
                let nxtLvlXp = result[0].Level * 300;
                let difference = nxtLvlXp - result[0].XP;
                let usermsg = new Discord.MessageEmbed()
                .setAuthor(msg.author.username)
				.addField(`Level`, result[0].Level, true)
				.addField(`XP`, result[0].XP, true)
				.setColor('76b3fc')
                .setFooter(`${difference} XP till level up`);//, msg.author.displayAvatarURL);
                
                msg.channel.send(usermsg);//.then(Message => { Message.delete({timeout: 5000})})
            } else { msg.channel.send(`Discord not linked to ExploiterChat`); }
        });
    }
};