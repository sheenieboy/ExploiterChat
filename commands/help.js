const Discord = require('discord.js');

module.exports = {
	name: 'help',
	aliases: ['help', 'commands', 'cmds'],
	description: "Get a list of commands",
	usage: '<commandName>',
	moderatorsOnly: false,
	ownerOnly: false,
	guildOnly: false,
	cooldown: 3,
	run(client, message, args, con) {
		function sendHelp() {
			var cmds = new Array();
			var modCmds = new Array();
			var ownerCmds = new Array();
			var olength =  Array.from(client.commands.values());;
			for (var i = 0; i < olength.length; i++) {
				var command = olength[i];
				if(command.ownerOnly == true) {
					ownerCmds.push(`**$${command.name} ${command.usage}**:  ${command.description}`);
				} else if(command.moderatorsOnly == true) {
					modCmds.push(`**$${command.name} ${command.usage}**: ${command.description}`);
				} else {
					cmds.push(`**$${command.name} ${command.usage}**: ${command.description}`);
				}
			}
			
			helpEmbed = new Discord.MessageEmbed()
			.setColor('RANDOM')
			.setAuthor('Command Help', client.user.avatarURL())
			.setDescription(`Here's a list of all the commands: \n${cmds.join("\n")}\n\n **MODERATION:** \n ${modCmds.join("\n")}\n\n **OWNER ONLY:**\n${ownerCmds.join("\n")}\n\nFor more information on a command, use \`${message.content.charAt(0)}help <comand name>\``);
			message.channel.send({ embed: helpEmbed });
		};
		
		if (!args.length) return sendHelp();
		commandName = args[0].toLowerCase();
		const command = client.commands.get(commandName) || client.commands.find(cmd => cmd.aliases && cmd.aliases.includes(commandName));

		let embed = new Discord.MessageEmbed()
		.setColor('RANDOM')
		.setTitle(`Command: ${command.name}`)
		.addField('Description', command.description || "None set")
		.addField('Expected Usage', command.usage || "none set", true)
		.addField('Guild Only', command.guildOnly == true ? "Yes" : "No", true)
		.addField('Owner Only', command.ownerOnly == true ? "Yes" : "No", true)
		message.channel.send({ embed });
	},
};